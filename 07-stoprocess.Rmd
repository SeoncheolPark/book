# 확률과정론 {#stoprocess}

참고할만한 책으로 [@Lindgren2012]가 있다.

## 확률과정이란?(stochastic process)

[@Lindgren2012]에 있는 그림이다.

```{r, echo=F, fig.cap='Overview of the threee types of worlds in which our processes live.', fig.align='center'}
knitr::include_graphics("images/basic_stprocess.png")
```

**확률과정(stochastic process)**란 확률공간에서 정의되는 확률변수들의 모임 $\{ Z, t \in T\}$라고 할 수 있다. 이 때 $T=(-\infty, \infty)$ 등과 같이 연속된 구간의 형태를 갖는 경우를 **연속형 확률과정(continuous stochastic process)**, $T=\{ 0, \pm 1, \pm 2 , \ldots\}$ 등과 같이 이산 구간일 경우는 **이산형 확률과정(discrete stochastic process)**라고 한다.

## 확률과정에서의 연속성(continuity of stochastic process)

```{definition, name="연속표본경로"}
과정 $X$가 $t_{0}$에서 연속이라 함은
$$\text{For almost all }\omega, t \rightarrow t_{0} \text{ implies } X(t,\omega) \rightarrow X(t_{0},\omega)$$
를 의미한다. 과정 $X$가 연속이라 함은
$$\text{For almost all }\omega, X(\cdot, \omega) \text{ is a continuous function}$$
임을 의미한다.

```

```{definition, name="CADLAG (CAGLAD)"}
Well-ordered set $T$에 있는 sample function $x$가 모든점에서 continuous from the right (left)하고 limited from the left (right)일 때 **CADLAG (CAGLAD)**이라고 한다. 즉, 모든 $t_{0}\in T$에서 $t\downarrow t_{0}$이 $x(t) \rightarrow x(t_{0})$를 의미하고 $t\uparrow t_{0}$일 때 $\lim_{t\uparrow t_{0}} x(t)$가 존재하나 꼭 $x(t_{0})$일 필요는 없는 상황임을 의미한다. 어떤 확률과정 $X$가 CADLAG임은 그것의 almost all sample path가 CADLAG임을 의미한다.

```

```{definition, name="확률과정의 version"}
Common index set $T$를 갖는 두 개의 확률과정 $X$와 $Y$이 서로의 **version**이라 함은
$$\forall t \in T, \mathbb{P}(\omega: X(t,\omega)=Y(t,\omega))=1$$
임을 의미한다. 이러한 과정들을 **stochastically equivalent**라고도 부른다. 이는 임의의 시간대에서 $X$와 $Y$는 almost surely equal이라는 것이다.

```

```{definition, name="확률과정의 구분불가능성"}
두 개의 확률과정 $X$와 $Y$가 **구분불가능(indistinguishable)** 또는 **euqivalent up to evanescense**하다는 것은
$$\mathbb{P}(\omega: \forall t, X(t,\omega)=Y(t,\omega))=1$$
임을 의미한다. 쉽게 얘기하면 $X$와 $Y$의 표본 경로가 equal almost surely라는 것이다.

```

구분불가능성을 갖는 확률과정은 서로의 version이 되나, 그 반대는 성립하지 않는다. 

그렇다면 확률과정에서 왜 연속성이 이슈가 되는가? 우리는 sample path를 보통 연속인 함수로 제한하고 싶어한다. 더 나아가 미분가능할 정도로 부드러운 함수를 다루고자 하는 경우가 많다. 물론 이는 수학적인 편리함을 위해서이다.

```{proposition}
$X(t,\omega)$를 실변수이며 연속 표본 경로를 갖는 연속 모수 과정이라고 하자. 그러면 모든 유한한 구간 $I$에 대해 $M(\omega)=\equiv \sup_{t\in I}X(t,\omega)$이고 $m(\omega)\equiv \inf_{t\in I}X(t,\omega)$는 가측 확률변수이다.

```

우리는 특정 시간에 관찰된 확률과정을 다룰 때 product $\sigma$-field를 보통 쓴다. Product $\sigma$-field는 countable question에 대해 답을 해 준다. 즉 어떤 measurable set $A$가 있으면 이 때 $x(\cdot, \omega)\in A$는 countably many indices $t$의 $x(t,\omega)$ value들에 depend해야한다는 것이다. 이것은 모든 continuous sample path들의 class가 not product $\sigma$-field measurable이 될 수도 있다는 것을 의미하는데, 그 이유는 $x(\cdot, \omega)$가 $t$에서 연속이라는 것은 모든 수열 $t_{n}\rightarrow t$에 대해 $x(t_{n},\omega)\rightarrow x(t,\omega)$라는 것을 의미하면 이것은 uncountably many coordinates들의 함숫값들을 포함하는 것이기 때문이다. 더 나아가 differentiable function들의 class 또한 $\sigma$-field measurable이 아니다.

## 분리가능한 무작위 함수들(separable random functions)

**분리가능(separable)**한 무작위 함수들의 기본 아이디어는 contable, dense subset만 다룬다는 것이다.

```{definition, name="분리가능 함수들(separable functions"}
$\Xi$와 $T$가 metric space라고 하고, $D$를 $T$의 countable, dense subset이라고 하자. 그러면 함수 $x: T\rightarrow \Xi$가 $\forall t\in T$에 대해 수열 $t_{i}\in D$가 존재해 $t_{i}\rightarrow t$ 그리고 $x(t_{i})\rightarrow x(t)$를 만족할 경우 함수 $x$를 **D-분리가능(D-separable)** 또는 D에 대해 분리가능하다고 한다.

```

```{lemma}
다음 조건들은 분리가능성의 충분조건이다.

1. $T$ is countable

2. $T$ is continuous

3. $T$ is well-ordered and $x$ is right-continuous.

```

```{proof}
1. $T$ 자체를 separating set으로 잡으면 된다.

2. 어떤 countable dense set $D$를 잡는다. Dense 성질에 의해 모든 $t$에 대해 다음과 같은 수열 $t_{i}\in D$가 존재해 $t_{i}\rightarrow t$이다. 연속성에 의해 $x(t_{i})\rightarrow t$가 된다.

3. 2와 마찬가지로 모든 coundtable dense $D$에 대해 $t_{i}>t$가 되도록인 채로 2와 같은 논리를 따라가면 된다.

```

```{definition, name="분리가능 과정"}
$\Xi$-valued process $X$ on $T$가 **D에 대해 분리가능(separable with respect to D)**하다는 것은 $D$가 $T$의 countable, dense subset이고 다음과 같은 measure-zero set $N\in\Omega$가 존재해 모든 $\omega \in N$에 대해 $X(\cdot, \omega)$가 $D$-분리가능이라는 것이다. 즉 $X(\cdot, \omega)$가 almost surely $D$-separable이라는 것이다.

```

## 경험과정(empirical process)

이 부분은 [@Jiang2010]을 참고했다. 확률변수들은 관찰값(observation)들의 형태로 얻어지는데, 관찰된 확률변수들로 구성된 함수를 우리는 특별히 **통계적 함수(statistical function)**이라고 부른다. 통계적 함수는 실제로 얻을 수 있다는 점에서 많은 사람들이 그 성질에 대해 관심을 갖는다. 보통은 통계적 함수들 중 **경험과정(empriical process)**이라고 부르는 것에 집중을 하게 된다. $X_{1},X_{2},\ldots $가 분포함수 $F$를 갖는 i.i.d. 확률변수들의 수열이라고 하자. 그러면 **경험적 분포함수(empirical distribution function)**은 다음과 같이 정의된다.
\begin{equation}
F_{n}(x)=\frac{1}{n}\sum_{i=1}^{n}1_{(X_{i}\leq x)}, -\infty < x < \infty.
(\#eq:empiricalDF)
\end{equation}

식 \@ref(eq:empiricalDF)은 쉬워보이지만 이 식의 뜻을 쉽게 이해하기는 어렵다. 여기서 $X_{i}$들은 관찰값들이고 $x$는 함수값이다. $X_{i}$들의 실현(realization)에 대해 식 \@ref(eq:empiricalDF)은 계단함수를 정의한다. 그리고 $X_{i}$들이 무작위이므로 식 \@ref(eq:empiricalDF) 또한 무작위이다. 즉 $X_{1},\ldots ,X_{n}$들이 매 번 실현될 때마다 다른 함수를 얻게 된다.

## 포아송과정(Poisson process)

## 포아송 무작위 측도들(Poisson random measures)

다음 [사이트](http://www.math.wisc.edu/~kurtz/735/main735.pdf)의 9장을 참고하였다. [@Mikhail2014] 또한 참고할만하다. $(E,\mathcal{E})$를 가측공간이라고 하고, $\nu$를 $\mathcal{E}$에서의 $\sigma$-finite 측도라고 하자. $\mathcal{N}(E)$는 $E$에서의 counting measure의 collection이라고 하자, 즉 음이 아닌 정수값들의 측도이다. $\xi$는 만약 각각의 $\omega \in \Omega$에서 $\xi(\omega, \cdot)\in\mathcal{N}(E)$이고 각각의 $A\in\mathcal{E}$에서 $\xi(A)$가 $\mathbb{N}\cup\{\infty\}$의 값을 갖는 확률변수일 때 확률공간 $(\Omega, \mathcal{F}, P)$에서의 $\mathcal{N}(E)$-확률변수다. 편의를 위해 $\xi(\omega, A)$대신 $\xi(A)$라고 쓰자.

```{definition, name="포아송 무작위 측도"}
어떤 $\mathcal{N}(E)$-확률변수가

1. 각각의 $A\in\mathcal{E}$에 대해 $\xi(A)\sim \text{Poisson}(\nu(A))$이다.

2. 만약 $A_{1},A_{},\ldots \in \mathcal{E}$가 disjoint이면 $\xi(A_{1}), \xi(A_{2}),\ldots $는 독립인 확률변수이다.

를 만족하면 **평균측도(mean measure)** $\nu$를 갖는 **포아송 무작위 측도(Poisson random measure)**이다. 

```

$\nu$는 $\xi$가 존재할 경우 $\xi$의 분포를 결정한다. 먼저 $\nu$가 유한하게 존재한다면 $\nu$가 $\sigma$-finite한 것으로 고려한다.

```{proposition}
$\nu$가 $(E,\mathcal{E})$에서의 측도이고 $\nu(E)<\infty$라고 하자. 그러면 평균측도 $\nu$를 갖는 포아송 무작위 측도가 존재한다.

```

평균측도를 다른 말로 intensity measure라고 부르기도 한다. 

## 브라운운동(Brownian motion)

```{definition, name="저차원에서의 브라운운동"}
실수값을 갖는 확률과정 $\{ B(t) : t\geq 0\}$이 다음 조건들을 만족할 때

1. $B(0)=x$

2. 그 과정이 독립 증분(independent increment)을 갖는다. 즉 모든 시간 $0 \leq t_{1} \leq t_{2} \leq \cdots \leq t_{n}$에 대해 증분 $B(t_{n})-B_(t_{n-1}),\ldots, B(t_{2})-B_(t_{1})$이 독립 확률변수다.

3. 모든 $t \geq 0$과 $h > 0$에 대해 증분 이 정규분포를 따른다.
$$B(t+h)-B(t) \sim \mathcal{N}(0,h).$$

4. 함수 $t \rightarrow B(t)$가 연속이다.

$x\in\mathbb{R}$에서 시작하는 (선형) **브라운운동(Brownian motion)**이라고 한다. 특별히 $x=0$일 때 $\{ B(t): t\geq 0\}$을 정규 브라운운동(standard Brownian motion)이라고 부른다.

```

브라운운동의 정의는 나중에 공간과정에도 잠시 나올 것이다.

### 분수 브라운운동(fractional Brownian motion)

**분수 브라운운동(fractional Brownian motion)**이란 fractional derivative (또는 fractional integral) of Brownian motion을 일컫는 말이다.

## 마팅게일(martingale)

**마팅게일(martingale)**은 평균 0을 갖는 독립인 확률변수들의 합의 일반화이다. 마팅게일은 확률과 통계에서 중요한 역할을 하며, 과거의 모든 정보를 알고 있다면 미래의 기댓값이 현재 값과 동일한 과정이다. 마팅게일이라는 말은 원래 도박에서 유래하였다고 한다. 마팅게일을 정의할 때는 조건부 기댓값이 중요한 역할을 한다.

```{definition, name="마팅게일"}
확률과정 $\{X_{n}\}$가 

1. $E |X_{n}| < \infty$

2. $X_{n}$ is adpated to $\mathcal{F}_{n}$. (즉 모든 $n$에 대해 $X_{n}\in\mathcal{F}_{n}$)

3. $E(X_{n+1}|\mathcal{F}_{n})=X_{n}, \text{ for all } n$

을 만족할 때, 이 확률과정을 filtration $\mathcal{F}_{n}$에 대한 **마팅게일(martingale)**이라 부른다.

```

## 마르코프 체인(Markov chain)

```{definition, name="마르코프 체인"}
**마르코프 체인(Markov chain)**이란 

$$P(X_{n+1}=X|X_{1}=x_{1}, X_{2}=x_{2}, \ldots , X_{n}=x_{n})=P(X_{n+1}=x|X_{n}=x_{n})$$

을 만족하는 확률변수들의 수열 $X_{1},X_{2},\ldots$를 일컫는다. 여기서$x_{i}$들은 countable set $S$에서 뽑힌 값들이며 $S$를 체인의 state space라고 부른다.

```
