# 분계점 방법들 {#pot}

지금까지는 블록 최대값으로 모델링하는 방법에 대해 생각해보았다. 그러나 이 방법은 데이터를 낭비한다고도 볼 수 있고, 모든 최대값이 진짜로 극단값인지에 대한 의문이 들게 된다. 즉 어떤 블록의 최대값이 아닌 값들이 다른 블록들의 최대값보다 훨씬 크지만 극단값으로 뽑히지 않는 상황이 발생하게 된다. 만약 시간별 또는 일별 관측값과 같은 상세한 시계열 자료를 얻을 수 있다면 블록화 하는 방법 이외에 다른 방법들 또한 고려해 볼 수 있을 것이다.

## 일반화 파레토 분포(generalized pareto distribution)

$X_{1},X_{2},\ldots$를 독립적이며 같은 분포를 따르며 분포함수 $F$를 갖는 확률변수들의 수열이라고 하자. 여기서 분계 $u$를 초과하는 $X_{i}$값들을 극단 사건(extreme event)라고 생각할 수 있다. $F$가 알려져 있는 분포라고 한다면
$$P\{X>u+y|X>u\}=\frac{1-F(x+y)}{1-F(u)}, y>0$$
이 성립한다.

주된 결과는 다음 정리에 포함되어 있다.

<div class="theorem">

$X_{1},X_{2},\ldots$이 분포함수 $F$를 갖는 독립인 확률변수의 수열이라고 하자. 그리고
$$M_{n}=\max\{X_{1},\ldots,X_{n}\}$$
을 정의한다. $F$가 극단 종류 정리를 만족한다면 충분히 큰 $n$에 대해
$$P\{M_{n}\leq z\}\approx G(z)$$
이 성립한다. 이때
$$G(z)=\exp\{-[1+\xi(\frac{z-\mu}{\sigma})]^{-1/\xi}\}$$
이며 여기서 $\mu, \sigma>0$이다. 그리고 충분히 큰 $u$에 대해 $X>u$일 때 $(X-u)$의 분포함수는
\begin{equation}
H(y)=1-(1+\frac{\xi y}{\tilde{\sigma}})^{-1/\xi}
\end{equation}
로 근사할 수 있다. 이 때 $\{ y: y > 0 \text{ and } (1+\xi y / \tilde{\sigma}) >0 \}$이며
\begin{equation}
\tilde{\sigma}=\sigma + \xi (x-\mu)
\end{equation}
이다.

</div>

## R-예제(r-pot)

R 패키지 `extRemes`의 vignette를 참고하였다.

```{r, message=F, echo=F}
library(extRemes)
```

```{r, fig.align='center', comment=">", fig.cap = 'Hurricane damage data.', cache=TRUE}
data(damage)
par(mfrow=c(1,3))
plot(damage$Year, damage$Dam, xlab = "Year",ylab = "U.S. Hurricane Damage (billion USD)")
plot(damage[,"Year"], log(damage[,"Dam"]), xlab = "Year", ylab = "ln(Damage)")
qqnorm(log(damage[,"Dam"]), ylim = c(-10, 5))
```

```{r, fig.align='center', comment=">", fig.cap = 'Thresh range plot of hurricane damage data.', cache=TRUE}
threshrange.plot(damage$Dam, r=c(1, 15), nint=20)
```

```{r, fig.align='center', comment=">", fig.cap = 'Mean residual life plot of hurricane damage data.', cache=TRUE}
par(mfrow=c(1,1))
mrlplot(damage$Dam, xlim = c(0, 12))
```

```{r, fig.align='center', comment=">", fig.cap = 'GPD estimation result.', cache=TRUE}
range(damage$Year)
1995 - 1926 + 1
dim(damage)
144 / 70
fitD <- fevd(Dam, damage, threshold = 6, type = "GP", time.units = "2.06/year")
fitD
plot(fitD)
pextRemes(fitD, c(20, 40, 60, 100), lower.tail = FALSE)
```
